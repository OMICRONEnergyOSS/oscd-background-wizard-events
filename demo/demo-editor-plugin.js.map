{"version":3,"file":"demo-editor-plugin.js","sources":["../../../demo/demo-editor-plugin.ts"],"sourcesContent":["import { css, html, LitElement } from 'lit';\nimport { property, query } from 'lit/decorators.js';\nimport type WizardDialog from '@omicronenergy/oscd-edit-dialog/OscdEditDialog.js';\n\nimport { XMLEditor } from '@omicronenergy/oscd-editor';\nimport {\n  emptyWizard,\n  wizards,\n} from '@omicronenergy/oscd-edit-dialog/wizards.js';\nimport { newCreateWizardEvent, newEditWizardEvent } from '../foundation.js';\n\nfunction prettyPrintXml(xml: XMLDocument | Element): string {\n  const serializer = new XMLSerializer();\n  const xmlStr = serializer.serializeToString(xml);\n\n  // Insert line breaks between tags\n  const xmlString = xmlStr.replace(/>(\\s*)</g, '>\\n<');\n  let formatted = '';\n  let pad = 0;\n\n  xmlString.split('\\n').forEach(node => {\n    if (node.match(/^<\\/[^>]+>/)) {\n      pad -= 2;\n    } // Closing tag\n    if (pad < 0) {\n      pad = 0;\n    }\n    formatted += ' '.repeat(pad) + node + '\\n';\n    if (node.match(/^<[^!?/][^>]*[^/]>$/)) {\n      pad += 2;\n    } // Opening tag (not self-closing, not comment/doctype)\n  });\n\n  return formatted.trim();\n}\n\nconst supportedCreateTagNames = Object.entries(wizards)\n  .filter(([, value]) => value.create !== emptyWizard)\n  .map(([key]) => key);\n\nconst supportedEditTagNames = Object.entries(wizards)\n  .filter(([, value]) => value.edit !== emptyWizard)\n  .map(([key]) => key);\n\nexport default class TriggerWizard extends LitElement {\n  @property()\n  doc!: XMLDocument;\n\n  @property()\n  editor!: XMLEditor;\n\n  @property()\n  editCount!: unknown;\n\n  @query('#newTagName') newTagName!: HTMLSelectElement;\n\n  @query('#parentSelector') parentSelector!: HTMLInputElement;\n\n  @query('#childtag') childinput!: HTMLInputElement;\n\n  @query('#tagSelector') tagSelector!: HTMLInputElement;\n\n  @query('oscd-edit-dialog') editDialog!: WizardDialog;\n\n  async triggerWizardCreate(): Promise<void> {\n    const parent = this.doc.querySelector(this.parentSelector.value);\n    const tagName = this.newTagName.value;\n    if (!parent || !tagName) {\n      return;\n    }\n\n    this.dispatchEvent(newCreateWizardEvent(parent, tagName));\n    this.requestUpdate();\n    console.log(new XMLSerializer().serializeToString(this.doc));\n  }\n\n  async triggerWizardEdit(): Promise<void> {\n    const element = this.doc.querySelector(this.tagSelector.value);\n\n    if (!element) {\n      this.tagSelector.setCustomValidity('Terrible selector, try again.');\n      this.tagSelector.reportValidity();\n      return;\n    } else if (!supportedEditTagNames.includes(element.tagName)) {\n      this.tagSelector.setCustomValidity(\n        'This tag name is not currently supported.',\n      );\n      this.tagSelector.reportValidity();\n      return;\n    } else {\n      this.tagSelector.setCustomValidity('');\n    }\n\n    this.dispatchEvent(newEditWizardEvent(element));\n    this.requestUpdate();\n  }\n\n  render() {\n    return html`<div class=\"card\">\n        <h2>Add Element</h2>\n        <p>\n          Use this section to trigger the oscd-edit-dialog to Add/Inert the\n          specified Element to the specified Parent\n        </p>\n        <label>Parent Selector:</label\n        ><input id=\"parentSelector\" value=\"Substation\" />\n        <label for=\"newTagName\">Tag Name:</label\n        ><select id=\"newTagName\">\n          ${supportedCreateTagNames.map(\n            tagName => html`<option value=${tagName}>${tagName}</option>`,\n          )}\n        </select>\n        <button @click=\"${this.triggerWizardCreate}\">Add</button>\n      </div>\n\n      <div class=\"card\">\n        <h2>Edit existing Element</h2>\n        <p>\n          Use this section to trigger the oscd-edit-dialog to Edit the specified\n          existing Element\n        </p>\n        <label>Tag Selector</label>\n        <div>\n          <input\n            id=\"tagSelector\"\n            value=\"Substation\"\n            aria-describedby=\"supportedEditElements\"\n          />\n          <div\n            role=\"tooltip\"\n            id=\"supportedEditElements\"\n            aria-label=\"Supported Elements for Editing\"\n          >\n            <h3>Supported Elements for Editing</h3>\n            <ul>\n              ${supportedEditTagNames.map(tagName => html`<li>${tagName}</li>`)}\n            </ul>\n          </div>\n        </div>\n        <button @click=\"${this.triggerWizardEdit}\">Edit</button>\n      </div>\n\n      <div class=\"card\">\n        <h2>Document Content</h2>\n        <pre style=\"white-space: break-spaces\">${prettyPrintXml(this.doc)}</pre>\n      </div> `;\n  }\n\n  static styles = css`\n    .card {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 1rem 2rem;\n      align-items: center;\n      justify-items: center;\n      padding: 2rem;\n      background: #fafbfc;\n      border-radius: 8px;\n      max-width: 500px;\n      margin: 2rem auto;\n    }\n\n    .card h2,\n    .card p,\n    .card button {\n      grid-column: 1 / -1;\n      text-align: center;\n      margin-block: 0;\n    }\n\n    .card label,\n    .card select,\n    .card input,\n    .card > div,\n    .card button {\n      width: 100%;\n    }\n\n    .card button {\n      text-align: center;\n    }\n\n    [role='tooltip'],\n    .hide-tooltip.hide-tooltip.hide-tooltip + [role='tooltip'] {\n      visibility: hidden;\n      position: absolute;\n      background: black;\n      color: white;\n      padding: 1rem;\n      border-radius: 8px;\n    }\n    [aria-describedby]:hover,\n    [aria-describedby]:focus {\n      position: relative;\n    }\n    [aria-describedby]:hover + [role='tooltip'],\n    [aria-describedby]:focus + [role='tooltip'] {\n      visibility: visible;\n    }\n  `;\n}\n"],"names":["LitElement","html","css","property","query"],"mappings":"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"}